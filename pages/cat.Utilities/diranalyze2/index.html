<!doctype html>
<html lang="en" class="antialiased">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DirAnalyze 2.0 – Static</title>
  <link rel="stylesheet" href="ui.css" />
</head>
<body>
<div id="app">
  <!-- Header -->
  <header>
    <div class="row between px-4 py-3">
      <div class="row g-3">
        <div class="logo">D2</div>
        <div>
          <div style="font-weight:700">DirAnalyze 2.0</div>
          <div class="muted" style="font-size:12px">Directory Analysis Tool</div>
        </div>
      </div>
      <div class="row g-2">
        <button class="btn" id="clearBtn">🗑️ Clear Project</button>
        <button class="btn ghost icon" id="themeBtn" title="Toggle theme">🌙</button>
      </div>
    </div>
  </header>

  <div class="shell">
    <!-- Sidebar -->
    <aside class="sidebar col" id="sidebar">
      <div class="divider" id="divider"></div>

      <div class="p-4" id="sidebarEmpty">
        <div class="card p-6 shadow">
          <div class="col g-3 center">
            <div class="drop-icon">📤</div>
            <div style="font-weight:600">Drop Folder Here</div>
            <div class="muted small">Drag & drop a folder or click to select</div>
            <div class="row g-2">
              <button class="btn" id="selectBtn">Select Folder</button>
              <input id="folderInput" type="file" style="display:none" webkitdirectory directory multiple />
            </div>
          </div>
        </div>
      </div>

      <div id="sidebarControls" style="display:none">
        <div class="p-4" style="border-bottom:1px solid var(--border)">
          <div class="row g-2 pb-2">
            <button class="btn" id="textReportBtn">⬇️ Text Report</button>
            <button class="btn" id="combinedBtn">🧩 Combined</button>
          </div>
          <div class="row g-2 pb-2">
            <button class="btn ghost" id="selectAllBtn">✅ All</button>
            <button class="btn ghost" id="selectNoneBtn">❌ None</button>
            <button class="btn ghost" id="expandAllBtn">🔎 Expand</button>
            <button class="btn ghost" id="collapseAllBtn">📉 Collapse</button>
          </div>
          <div class="col g-2">
            <label class="small">Include patterns</label>
            <input class="input" id="includeFilter" placeholder="*.js, *.css" />
            <label class="small">Exclude patterns</label>
            <input class="input" id="excludeFilter" />
            <label class="row g-2 small" style="align-items:center">
              <input type="checkbox" class="checkbox" id="showHiddenChk">
              Show hidden files
            </label>
          </div>
        </div>
        <div class="tree" id="tree"></div>
      </div>
    </aside>

    <!-- Main -->
    <main class="main">
      <div id="editorToolbar" class="row between p-4 toolbar">
        <div class="row g-2">
          <button class="btn" id="copyLinesBtn">📋 Copy with Lines</button>
          <button class="btn" id="patchBtn">⚙️ Apply Patch</button>
          <button class="btn" id="saveBtn" disabled>💾 Save</button>
          <button class="btn" id="closeBtn">✖️ Close</button>
        </div>
        <div id="currentFileLabel" class="muted small"></div>
      </div>

      <section id="mainTreePane" class="col main-pane">
        <div class="row between p-4 pane-head">
          <div class="row g-2" style="align-items:center">
            <div class="title">Directory Structure</div>
            <span class="badge" id="committedBadge">0 committed files</span>
          </div>
          <button class="btn" id="copyTreeBtn" disabled>📋 Copy Report</button>
        </div>
        <div class="pane-scroll">
          <pre id="treeReport" class="card p-4 report-pre"></pre>
          <div id="emptyState" class="col center g-3 empty">
            <div class="empty-icon">📄</div>
            <div class="empty-title"><span id="emptyTitle">No files loaded</span></div>
            <div id="emptyDesc" class="muted">Drop a folder to get started with directory analysis</div>
            <div class="row g-2" id="statsRow" style="display:none">
              <span class="badge" id="totalFilesBadge">0 total files</span>
              <span class="badge" id="selectedFilesBadge">0 selected</span>
            </div>
          </div>
        </div>
      </section>

      <section id="editorPane" class="editor-pane">
        <div class="editor">
          <div class="linenums" id="linenums">
            <div id="linenumsInner" class="linenums-inner"></div>
          </div>
          <textarea class="textarea" id="editor" spellcheck="false"></textarea>
        </div>
      </section>
    </main>
  </div>

  <footer class="status px-4 py-2">
    <div class="row between">
      <div class="row g-4">
        <span id="statusFiles">0 files</span>
        <span id="statusSelected">0 selected</span>
        <span id="statusSize">0 B</span>
      </div>
      <div id="statusMsg">Ready</div>
    </div>
  </footer>
</div>

<!-- Apply Patch dialog -->
<dialog id="patchDialog">
  <div class="dlg-head row between">
    <div style="font-weight:600">Apply AI Patches</div>
    <button class="btn ghost icon" onclick="patchDialog.close()">✖️</button>
  </div>
  <div class="dlg-body col g-3">
    <div class="muted small">Paste patches with this format:
      <pre class="card p-3 mono">FILE: path/to/file.js
12-14:
    // new code here</pre>
    </div>
    <textarea id="patchInput" class="textarea dlg-input"></textarea>
    <div class="row" style="justify-content:flex-end; gap:.5rem">
      <button class="btn" onclick="patchDialog.close()">Cancel</button>
      <button class="btn primary" id="applyPatchesBtn">Apply Patches</button>
    </div>
  </div>
</dialog>

<div id="toast" class="toast" style="display:none"></div>

<script defer src="report.js"></script>
<script defer src="app.js"></script>
</body>
</html>
