<!-- Single-file, client-only PDF image extractor. No server. Based on your original UI :contentReference[oaicite:0]{index=0} -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PDF Image Extractor — Asset Sucker</title>
<link rel="preconnect" href="https://cdnjs.cloudflare.com">
<style>
  :root{--bg:#0b0f17;--panel:#0e1525;--card:#121a2b;--muted:#99a4b8;--text:#e6edf7;--brand:#7c9cff;--accent:#28d7e5;--border:#1c2740;--ring:rgba(124,156,255,.35);--tile:220px}
  *{box-sizing:border-box} html,body{height:100%} body{margin:0;color:var(--text);background:var(--bg);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
  .container{max-width:1200px;margin:36px auto;padding:0 16px}
  .card{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));border:1px solid var(--border);border-radius:18px;box-shadow:0 16px 60px rgba(0,0,0,.35);overflow:hidden}
  .header{padding:22px;border-bottom:1px solid var(--border)}
  .title{margin:0;font-weight:700;font-size:22px;display:flex;gap:10px;align-items:center}
  .badge{font-size:12px;color:#031126;background:linear-gradient(135deg,var(--brand),var(--accent));padding:4px 8px;border-radius:999px;font-weight:600}
  .kicker{margin:8px 0 0;color:var(--muted);font-size:13px}
  .content{padding:18px 22px 26px}
  .form{display:flex;gap:10px;flex-wrap:wrap}
  .input{flex:1;min-width:220px;background:#0c1221;border:1px solid var(--border);color:var(--text);padding:12px 14px;border-radius:12px;outline:none}
  .input:focus{box-shadow:0 0 0 3px var(--ring)}
  .button{background:linear-gradient(135deg,var(--brand),var(--accent));color:#05101f;border:none;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer}
  .button:disabled{opacity:.6;cursor:not-allowed}
  .secondary{background:#0c1221;color:var(--text);border:1px solid var(--border)}
  .toolbar{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap;align-items:center}
  .toolbar-field{display:flex;gap:8px;align-items:center}
  .toolbar-field>span{color:var(--muted);font-size:12px}
  .badge-count{background:#0c1221;border:1px solid var(--border);color:var(--muted);padding:3px 8px;border-radius:999px;font-size:12px}
  .tabs{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
  .tab{background:#0c1221;color:var(--text);border:1px solid var(--border);padding:8px 12px;border-radius:999px;cursor:pointer;font-size:13px}
  .tab.active{background:linear-gradient(135deg,var(--brand),var(--accent));color:#05101f;border:none}
  .sep{border:none;height:1px;background:var(--border);margin:14px 0}
  .empty{font-size:14px;color:var(--muted);border:1px dashed var(--border);background:#0b1220;padding:16px;border-radius:12px;text-align:center;margin-top:8px}
  .grid{--gap:10px;display:grid;gap:var(--gap);grid-template-columns:repeat(auto-fill,minmax(var(--tile),1fr))}
  .tile{position:relative;border:1px solid var(--border);background:#0d1527;border-radius:14px;overflow:hidden;cursor:pointer}
  .thumb{position:relative;width:100%;aspect-ratio:1/1;background:#0c1221}
  .thumb img{width:100%;height:100%;object-fit:cover;display:block}
  .chip{position:absolute;top:8px;left:8px;background:rgba(5,16,31,.7);color:var(--muted);font-size:11px;padding:4px 6px;border-radius:6px;border:1px solid var(--border);backdrop-filter:blur(4px)}
  .tile .footer{position:absolute;inset:auto 0 0 0;padding:10px 12px;background:linear-gradient(180deg,rgba(5,16,31,0) 0%,rgba(5,16,31,.7) 55%,rgba(5,16,31,.9) 100%);opacity:0;transition:opacity .16s ease;pointer-events:none}
  .tile:hover .footer{opacity:1}
  .row{display:flex;gap:10px;align-items:center;justify-content:space-between}
  .meta{display:grid;gap:2px;min-width:0}
  .name{font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .sub{font-size:11.5px;color:var(--muted)}
  .btn{font-size:12px;padding:6px 8px;border-radius:8px;text-decoration:none;background:#0e162a;color:var(--text);border:1px solid var(--border);pointer-events:auto}
  .btn:hover{filter:brightness(1.15)}
  .lightbox{position:fixed;inset:0;background:rgba(4,10,20,.85);display:none;align-items:center;justify-content:center;padding:24px;z-index:50}
  .lb-card{width:min(92vw,1200px);background:#121a2b;border:1px solid var(--border);border-radius:16px;overflow:hidden;box-shadow:0 20px 80px rgba(0,0,0,.6)}
  .lb-head{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-bottom:1px solid var(--border)}
  .lb-title{font-size:14px;white-space:nowrap;overflow:auto;max-width:70%}
  .lb-actions{display:flex;gap:8px}
  .lb-body{position:relative;background:#0b1220;display:grid;place-items:center;max-height:80vh}
  .lb-body img{max-width:100%;max-height:80vh;display:block}
  .navbtn{position:absolute;top:50%;transform:translateY(-50%);border:1px solid var(--border);background:#0e162a;color:var(--text);border-radius:10px;padding:10px 12px;cursor:pointer}
  .navbtn:hover{filter:brightness(1.2)} .navprev{left:12px} .navnext{right:12px}
  .lb-close{background:#0e162a;color:var(--text);border:1px solid var(--border);border-radius:10px;padding:8px 10px;cursor:pointer}
  .hint{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <div class="header">
      <h1 class="title">Asset Sucker <span class="badge">PDF → images (client-only)</span></h1>
      <p class="kicker">Upload a PDF. We’ll extract page snapshots or embedded images (experimental) and let you save or ZIP them — all in your browser.</p>
    </div>
    <div class="content">
      <div class="form">
        <input class="input" id="file-input" type="file" accept="application/pdf">
        <button class="button" id="extract-btn">Extract</button>
        <button class="button secondary" id="zip-btn" disabled>Download ZIP</button>
      </div>
      <div class="toolbar">
        <label class="toolbar-field" title="How sharp exported page images are"><span>Page scale</span><input type="range" id="scale-slider" min="1" max="3" step="0.25" value="2"></label>
        <label class="toolbar-field"><span>Mode</span>
          <select id="mode-select" class="input" style="width:220px">
            <option value="pages">Page snapshots (reliable)</option>
            <option value="images">Embedded images (experimental)</option>
            <option value="both">Both</option>
          </select>
        </label>
        <label class="toolbar-field" title="Tile size"><span>Density</span><input type="range" id="density-slider" min="160" max="320" value="220"></label>
        <span class="hint" id="status-hint">Idle</span>
      </div>
      <div class="stats" id="stats-bar" style="display:none"></div>
      <div class="tabs" id="tabs-bar"></div>
      <hr class="sep">
      <div id="grid-container"><div class="empty">Nothing yet. Choose a PDF and click Extract.</div></div>
    </div>
  </div>
</div>
<div class="lightbox" id="lightbox"></div>

<!-- pdf.js + worker (CDN) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.4.168/pdf.min.js" integrity="sha512-aq4ixqlh5gKj/M7GTC18m0+H73ujQ4nYbV4c0oUJjygs83qphR8K7QpQa2nr5+iS0aUba4dI9oJwdQkFt6XyHw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.4.168/pdf.worker.min.js";</script>
<!-- JSZip (CDN) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js" integrity="sha512-/s63+8qTV6R9tUyA6Y8fJx2N1y9B3VMyVnQJzsxw9DgHfHnqU9mM3a8mD6I7K1b6m9b9v+0G4sY0I0C4Fj4z8g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script type="module">
  // --- State ---
  let loading=false, allAssets=[], counts=null, activeTab='all', lightboxIndex=null, errorMessage='', lastFileName='';
  // --- DOM ---
  const $=s=>document.querySelector(s);
  const fileInput=$('#file-input'), extractBtn=$('#extract-btn'), zipBtn=$('#zip-btn'), scaleSlider=$('#scale-slider'), modeSelect=$('#mode-select'), densitySlider=$('#density-slider'), statsBar=$('#stats-bar'), tabsBar=$('#tabs-bar'), gridContainer=$('#grid-container'), lightbox=$('#lightbox'), statusHint=$('#status-hint');

  // --- Utils ---
  const setStatus=t=>statusHint.textContent=t;
  const extFromDataUrl=u=>{if(/^data:image\/jpeg/i.test(u))return'jpg'; if(/^data:image\/png/i.test(u))return'png'; if(/^data:image\/gif/i.test(u))return'gif'; if(/^data:image\/webp/i.test(u))return'webp'; return'img'};
  const dataURLtoUint8Array=u=>{const b64=u.split(',')[1]; const bin=atob(b64); const len=bin.length; const arr=new Uint8Array(len); for(let i=0;i<len;i++) arr[i]=bin.charCodeAt(i); return arr};
  const uniq=(arr)=>Array.from(new Map(arr.map(a=>[a.url,a])).values());
  const byCategory=(c)=>allAssets.filter(a=>c==='all'||a.category===c);
  const formatName=(base,i,ext)=>`${base}_${String(i).padStart(3,'0')}.${ext}`;
  const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));

  // --- Rendering ---
  function render(){
    [fileInput,extractBtn,zipBtn,scaleSlider,modeSelect,densitySlider,...tabsBar.children].forEach(el=>el.disabled=loading);
    extractBtn.textContent=loading?'Working...':'Extract';
    zipBtn.textContent=loading?'…':'Download ZIP';
    zipBtn.disabled=loading||allAssets.length===0;

    if(counts){ statsBar.style.display='flex'; statsBar.innerHTML=`<span class="badge-count">${allAssets.length} total</span>${Object.entries(counts).map(([k,v])=>v>0?`<span class="badge-count">${k} ${v}</span>`:'').join('')}` } else { statsBar.style.display='none' }

    const tabs=['all','pages','images'];
    tabsBar.innerHTML=tabs.map(key=>`<button class="tab ${activeTab===key?'active':''}" data-tab="${key}" ${allAssets.length===0?'disabled':''}>${key.charAt(0).toUpperCase()+key.slice(1)}</button>`).join('');

    if(errorMessage){ gridContainer.innerHTML=`<div class="empty" style="color:#ff9a9a"><b>Error:</b> ${errorMessage}</div>`; return }
    const filtered=byCategory(activeTab);
    if(filtered.length===0){ gridContainer.innerHTML=`<div class="empty">${allAssets.length===0?'Nothing yet. Choose a PDF and click Extract.':'No assets for this tab.'}</div>`; return }

    gridContainer.innerHTML=`<div class="grid" role="list">${filtered.map((a,i)=>`
      <div class="tile" role="listitem" data-index="${i}">
        <div class="thumb"><img src="${a.url}" alt="" loading="lazy"><div class="chip">${a.ext||a.category}</div></div>
        <div class="footer"><div class="row">
          <div class="meta"><div class="name" title="${a.name}">${a.name}</div><div class="sub">${a.category} • ${a.w}×${a.h}</div></div>
          <div class="lb-actions">
            <a class="btn" href="${a.url}" download="${a.name}">Save</a>
            <button class="btn" data-copy-url="${a.url}">Copy Data URL</button>
          </div>
        </div></div>
      </div>`).join('')}</div>`;
  }

  // --- Lightbox ---
  function openLightbox(index){
    lightboxIndex=index; const filtered=byCategory(activeTab); const asset=filtered[lightboxIndex]; if(!asset){ closeLightbox(); return }
    lightbox.innerHTML=`
      <div class="lb-card">
        <div class="lb-head">
          <div class="lb-title">${asset.name}</div>
          <div class="lb-actions">
            <a class="btn" href="${asset.url}" download="${asset.name}">Download</a>
            <button class="lb-close">Close</button>
          </div>
        </div>
        <div class="lb-body">
          <img src="${asset.url}" alt="" loading="eager">
          ${lightboxIndex>0?`<button class="navbtn navprev">←</button>`:''}
          ${lightboxIndex<filtered.length-1?`<button class="navbtn navnext">→</button>`:''}
        </div>
      </div>`;
    lightbox.style.display='flex';
  }
  function closeLightbox(){ lightboxIndex=null; lightbox.style.display='none' }

  // --- Extraction (pdf.js) ---
  async function extract(){
    if(!fileInput.files.length){ errorMessage='Pick a PDF first.'; render(); return }
    loading=true; setStatus('Loading PDF…'); allAssets=[]; counts=null; errorMessage=''; render();
    try{
      const file=fileInput.files[0]; lastFileName=(file.name||'document').replace(/\.[^.]+$/,'')||'document';
      const ab=await file.arrayBuffer();
      const pdf=await pdfjsLib.getDocument({data:ab}).promise;
      const mode=modeSelect.value, scale=clamp(parseFloat(scaleSlider.value)||2,1,3);
      const assets=[];

      for(let p=1;p<=pdf.numPages;p++){
        setStatus(`Processing page ${p}/${pdf.numPages}…`);
        const page=await pdf.getPage(p);
        const viewport=page.getViewport({scale});

        if(mode!=='images'){
          const c=document.createElement('canvas'); const ctx=c.getContext('2d',{willReadFrequently:true});
          c.width=viewport.width; c.height=viewport.height;
          await page.render({canvasContext:ctx,viewport}).promise;
          const url=c.toDataURL('image/png'); assets.push({url,category:'pages',name:`${lastFileName}_page_${String(p).padStart(3,'0')}.png`,ext:'png',w:c.width,h:c.height});
        }

        if(mode!=='pages'){
          const grabbed=await grabEmbeddedImages(page,viewport);
          grabbed.forEach((g,i)=>assets.push({url:g.url,category:'images',name:`${lastFileName}_p${String(p).padStart(3,'0')}_img_${String(i+1).padStart(2,'0')}.${g.ext}`,ext:g.ext,w:g.w,h:g.h}));
        }
      }

      allAssets=uniq(assets);
      counts={pages:allAssets.filter(a=>a.category==='pages').length, images:allAssets.filter(a=>a.category==='images').length};
      activeTab=counts.images? 'images' : 'pages';
      setStatus('Done'); render();
    }catch(e){ errorMessage=e?.message||'Failed to process PDF.'; setStatus('Error'); render() }
    finally{ loading=false; render() }
  }

  // Capture embedded images by monkey-patching drawImage during a render
  async function grabEmbeddedImages(page,viewport){
    const c=document.createElement('canvas'); const ctx=c.getContext('2d',{willReadFrequently:true});
    c.width=viewport.width; c.height=viewport.height;
    const seen=new WeakSet(), out=[];
    const orig=ctx.drawImage.bind(ctx);
    ctx.drawImage=function(img, ...rest){
      try{ if(!seen.has(img)){ seen.add(img); const w=img.width||img.videoWidth||rest[2]||rest[4]||0; const h=img.height||img.videoHeight||rest[3]||rest[5]||0;
        if(w>4&&h>4){ const t=document.createElement('canvas'); const tctx=t.getContext('2d'); t.width=w; t.height=h; tctx.drawImage(img,0,0,w,h); const url=t.toDataURL('image/png'); out.push({url,ext:'png',w,h}) } } }catch{}
      return orig(img, ...rest);
    };
    await page.render({canvasContext:ctx,viewport}).promise;
    return out;
  }

  // --- ZIP ---
  async function downloadZip(){
    if(allAssets.length===0) return;
    loading=true; setStatus('Zipping…'); render();
    try{
      const zip=new JSZip();
      const base=lastFileName||'assets';
      allAssets.forEach((a,i)=>{ const data=dataURLtoUint8Array(a.url); zip.file(a.name||formatName(base,i+1,a.ext||extFromDataUrl(a.url)),data) });
      const blob=await zip.generateAsync({type:'blob'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=`assets_${base}.zip`; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(a.href); setStatus('ZIP ready');
    }catch(e){ errorMessage=e?.message||'ZIP failed.'; setStatus('Error') }
    finally{ loading=false; render() }
  }

  // --- Events ---
  extractBtn.addEventListener('click',extract);
  zipBtn.addEventListener('click',downloadZip);
  densitySlider.addEventListener('input',e=>document.documentElement.style.setProperty('--tile',`${e.target.value}px`));
  tabsBar.addEventListener('click',e=>{ if(e.target.classList.contains('tab')){ activeTab=e.target.dataset.tab; render() } });
  gridContainer.addEventListener('click',e=>{ const tile=e.target.closest('.tile'); const copyBtn=e.target.closest('[data-copy-url]'); if(copyBtn){ navigator.clipboard.writeText(copyBtn.dataset.copyUrl); return } if(e.target.closest('a,button')) return; if(tile) openLightbox(parseInt(tile.dataset.index,10)) });
  lightbox.addEventListener('click',e=>{ if(e.target.closest('.lb-close')) closeLightbox(); else if(e.target.closest('.navprev')) openLightbox(lightboxIndex-1); else if(e.target.closest('.navnext')) openLightbox(lightboxIndex+1); else if(!e.target.closest('.lb-card')) closeLightbox() });
  window.addEventListener('keydown',e=>{ if(lightboxIndex===null) return; if(e.key==='Escape') closeLightbox(); if(e.key==='ArrowRight'&&lightboxIndex<byCategory(activeTab).length-1) openLightbox(lightboxIndex+1); if(e.key==='ArrowLeft'&&lightboxIndex>0) openLightbox(lightboxIndex-1) });

  // --- Initial ---
  setStatus('Idle'); render();
</script>
</body>
</html>
