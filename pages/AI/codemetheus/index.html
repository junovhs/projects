<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>The Warden Protocol</title>
        <link
            href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap"
            rel="stylesheet"
        />
        <script type="importmap">
            {
                "imports": {
                    "react": "https://esm.sh/react@18.2.0",
                    "react-dom": "https://esm.sh/react-dom@18.2.0/client"
                }
            }
        </script>
        <style>
            :root {
                --bg: #0a0a0a;
                --primary: #ff4444;
                --secondary: #ff6b6b;
                --accent: #ffaa00;
                --warning: #ff9800;
                --text: #e8e8e8;
                --muted: #888888;
                --border: #333333;

                /* Refactoros Theme */
                --primary-refactor: #ff7b5c;
                --secondary-refactor: #ff9b5c;
            }

            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }
            html,
            body,
            #root {
                height: 100%;
            }

            body {
                font-family:
                    "Inter",
                    system-ui,
                    -apple-system,
                    sans-serif;
                background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 100%);
                color: var(--text);
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                overflow-x: hidden;
                position: relative;
            }

            body::before {
                content: "";
                position: absolute;
                inset: 0;
                background: repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(255, 68, 68, 0.03) 2px,
                    rgba(255, 68, 68, 0.03) 4px
                );
                pointer-events: none;
                opacity: 0.3;
            }

            .app {
                width: 100%;
                max-width: 900px;
                padding: 32px;
                text-align: center;
                position: relative;
                z-index: 10;
            }

            .carousel-viewport {
                width: 100%;
                overflow: hidden;
            }

            .carousel-track {
                display: flex;
                width: 200%;
                transition: transform 600ms cubic-bezier(0.4, 0, 0.2, 1);
            }

            .carousel-track.view-refactor {
                transform: translateX(-50%);
            }

            .card-slide {
                width: 50%;
                flex-shrink: 0;
                padding: 16px;
            }

            .scanlines {
                position: absolute;
                inset: 0;
                overflow: hidden;
                pointer-events: none;
                background: repeating-linear-gradient(
                    0deg,
                    rgba(0, 0, 0, 0.15),
                    rgba(0, 0, 0, 0.15) 1px,
                    transparent 1px,
                    transparent 2px
                );
                animation: scan 8s linear infinite;
            }

            @keyframes scan {
                0% {
                    transform: translateY(0);
                }
                100% {
                    transform: translateY(100%);
                }
            }

            header {
                margin-bottom: 32px;
            }

            .warden-badge {
                width: 120px;
                height: 120px;
                margin: 0 auto 24px;
                position: relative;
            }

            .badge-inner {
                width: 120px;
                height: 120px;
                background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
                display: flex;
                align-items: center;
                justify-content: center;
                font-family: "JetBrains Mono", monospace;
                font-size: 48px;
                font-weight: 700;
                color: var(--primary);
                position: relative;
                clip-path: polygon(
                    30% 0%,
                    70% 0%,
                    100% 30%,
                    100% 70%,
                    70% 100%,
                    30% 100%,
                    0% 70%,
                    0% 30%
                );
                border: 3px solid var(--primary);
                box-shadow:
                    0 0 30px rgba(255, 68, 68, 0.4),
                    inset 0 0 30px rgba(255, 68, 68, 0.1);
                animation: pulse-glow 2s ease-in-out infinite;
                transition: all 500ms ease;
            }

            .app.theme-refactor .badge-inner {
                color: var(--primary-refactor);
                border-color: var(--primary-refactor);
                box-shadow:
                    0 0 30px rgba(255, 123, 92, 0.4),
                    inset 0 0 30px rgba(255, 123, 92, 0.1);
            }

            @keyframes pulse-glow {
                0%,
                100% {
                    box-shadow:
                        0 0 30px rgba(255, 68, 68, 0.4),
                        inset 0 0 30px rgba(255, 68, 68, 0.1);
                }
                50% {
                    box-shadow:
                        0 0 50px rgba(255, 68, 68, 0.6),
                        inset 0 0 50px rgba(255, 68, 68, 0.2);
                }
            }

            .warden-badge::before {
                content: "";
                position: absolute;
                inset: -12px;
                clip-path: polygon(
                    30% 0%,
                    70% 0%,
                    100% 30%,
                    100% 70%,
                    70% 100%,
                    30% 100%,
                    0% 70%,
                    0% 30%
                );
                border: 1px solid var(--primary);
                opacity: 0.3;
                animation: rotate-border 20s linear infinite;
            }

            @keyframes rotate-border {
                from {
                    transform: rotate(0deg);
                }
                to {
                    transform: rotate(360deg);
                }
            }

            h1 {
                font-family: "JetBrains Mono", monospace;
                font-size: 48px;
                font-weight: 700;
                margin-bottom: 8px;
                color: var(--primary);
                letter-spacing: 0.1em;
                text-transform: uppercase;
                text-shadow: 0 0 20px rgba(255, 68, 68, 0.5);
                transition: all 500ms ease;
            }

            .app.theme-refactor h1 {
                color: var(--primary-refactor);
                text-shadow: 0 0 20px rgba(255, 123, 92, 0.5);
            }

            .subtitle {
                font-family: "JetBrains Mono", monospace;
                font-size: 12px;
                color: var(--muted);
                text-transform: uppercase;
                letter-spacing: 0.2em;
                font-weight: 400;
            }

            .protocol-container {
                position: relative;
                margin: 0 auto;
                max-width: 600px;
            }

            .protocol-card {
                position: relative;
                cursor: pointer;
                transition: transform 300ms cubic-bezier(0.4, 0, 0.2, 1);
            }

            .protocol-card:hover {
                transform: scale(1.02);
            }

            .protocol-card.enforcing {
                animation: enforce 600ms ease-out;
            }

            @keyframes enforce {
                0%,
                100% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.05);
                }
            }

            .card-bg {
                position: absolute;
                inset: 0;
                background: linear-gradient(135deg, #1a1a1a 0%, #0f0f0f 100%);
                border: 2px solid var(--primary);
                box-shadow:
                    0 10px 40px rgba(0, 0, 0, 0.8),
                    inset 0 2px 0 rgba(255, 255, 255, 0.05),
                    0 0 30px rgba(255, 68, 68, 0.2);
                transition: all 500ms ease;
            }

            .app.theme-refactor .card-bg {
                border-color: var(--primary-refactor);
                box-shadow:
                    0 10px 40px rgba(0, 0, 0, 0.8),
                    inset 0 2px 0 rgba(255, 255, 255, 0.05),
                    0 0 30px rgba(255, 123, 92, 0.2);
            }

            .card-bg::before {
                content: "";
                position: absolute;
                inset: 0;
                background: repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 10px,
                    rgba(255, 68, 68, 0.05) 10px,
                    rgba(255, 68, 68, 0.05) 11px
                );
            }

            .content {
                position: relative;
                padding: 40px 32px;
            }

            .enforce-text {
                font-family: "JetBrains Mono", monospace;
                font-size: 14px;
                color: var(--warning);
                text-transform: uppercase;
                letter-spacing: 0.15em;
                margin-bottom: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 12px;
                font-weight: 600;
            }

            .enforce-text::before,
            .enforce-text::after {
                content: "‚ö†";
                font-size: 16px;
                animation: blink 1.5s ease-in-out infinite;
            }

            @keyframes blink {
                0%,
                100% {
                    opacity: 1;
                }
                50% {
                    opacity: 0.3;
                }
            }

            .protocol-title {
                font-family: "JetBrains Mono", monospace;
                font-size: 20px;
                font-weight: 700;
                margin-bottom: 32px;
                color: var(--text);
                text-transform: uppercase;
                letter-spacing: 0.1em;
            }

            .law-section {
                margin-bottom: 24px;
                text-align: left;
                border-left: 3px solid var(--primary);
                padding-left: 16px;
                transition: border-color 500ms ease;
            }

            .app.theme-refactor .law-section {
                border-left-color: var(--primary-refactor);
            }

            .law-title {
                font-family: "JetBrains Mono", monospace;
                font-size: 14px;
                color: var(--primary);
                margin-bottom: 8px;
                font-weight: 700;
                text-transform: uppercase;
                letter-spacing: 0.05em;
                transition: color 500ms ease;
            }

            .app.theme-refactor .law-title {
                color: var(--primary-refactor);
            }

            .law-description {
                font-size: 13px;
                color: var(--muted);
                line-height: 1.6;
                font-family: "Inter", sans-serif;
            }

            .law-description code {
                font-family: "JetBrains Mono", monospace;
                background: rgba(255, 68, 68, 0.1);
                padding: 2px 6px;
                border-radius: 3px;
                font-size: 12px;
                color: var(--secondary);
            }

            .enforcement-notice {
                margin-top: 32px;
                padding: 16px;
                background: rgba(255, 68, 68, 0.05);
                border: 1px solid rgba(255, 68, 68, 0.2);
                border-left: 4px solid var(--primary);
                font-size: 12px;
                color: var(--muted);
                font-family: "JetBrains Mono", monospace;
                line-height: 1.8;
                text-align: left;
                transition: border-color 500ms ease;
            }

            .app.theme-refactor .enforcement-notice {
                border-left-color: var(--primary-refactor);
                background: rgba(255, 123, 92, 0.05);
                border-color: rgba(255, 123, 92, 0.2);
            }

            .enforcement-notice strong {
                color: var(--text);
                font-weight: 700;
            }

            .toast {
                position: fixed;
                bottom: 32px;
                left: 50%;
                transform: translateX(-50%) translateY(100px);
                background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
                color: var(--primary);
                padding: 16px 24px;
                border: 2px solid var(--primary);
                font-weight: 600;
                font-size: 14px;
                font-family: "JetBrains Mono", monospace;
                box-shadow: 0 10px 40px rgba(255, 68, 68, 0.5);
                display: flex;
                gap: 12px;
                align-items: center;
                opacity: 0;
                pointer-events: none;
                transition: all 400ms cubic-bezier(0.4, 0, 0.2, 1);
                z-index: 9999;
            }

            .app.theme-refactor .toast {
                color: var(--primary-refactor);
                border-color: var(--primary-refactor);
                box-shadow: 0 10px 40px rgba(255, 123, 92, 0.5);
            }

            .toast.show {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
                pointer-events: auto;
            }

            .nav-controls {
                display: flex;
                justify-content: center;
                gap: 24px;
                margin-bottom: 32px;
                position: relative;
                z-index: 20;
            }

            .nav-button {
                font-family: "JetBrains Mono", monospace;
                font-size: 12px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.15em;
                color: var(--muted);
                background: none;
                border: 2px solid transparent;
                padding: 12px 24px;
                cursor: pointer;
                position: relative;
                transition: all 300ms ease;
                clip-path: polygon(
                    8px 0,
                    100% 0,
                    100% calc(100% - 8px),
                    calc(100% - 8px) 100%,
                    0 100%,
                    0 8px
                );
            }

            .nav-button:hover {
                color: var(--text);
                border-color: var(--border);
            }

            .nav-button.active {
                color: var(--text);
                background: rgba(255, 68, 68, 0.1);
                border-color: var(--primary);
            }

            .mandate-grid {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 12px;
                padding: 16px;
                max-width: 100%;
            }

            .mandate-card {
                position: relative;
                cursor: pointer;
                transition: transform 300ms cubic-bezier(0.4, 0, 0.2, 1);
                min-height: 520px;
            }

            .mandate-card:hover {
                transform: translateY(-4px);
            }

            .mandate-card.summoning {
                animation: enforce 600ms ease-out;
            }

            .mandate-bg {
                position: absolute;
                inset: 0;
                background: linear-gradient(135deg, #1a1a1a 0%, #0f0f0f 100%);
                border: 2px solid rgba(255, 123, 92, 0.3);
                box-shadow:
                    0 10px 30px rgba(0, 0, 0, 0.6),
                    inset 0 1px 0 rgba(255, 255, 255, 0.05);
                transition: all 300ms ease;
            }

            .mandate-card:hover .mandate-bg {
                border-color: rgba(255, 123, 92, 0.5);
                box-shadow:
                    0 15px 40px rgba(0, 0, 0, 0.7),
                    inset 0 1px 0 rgba(255, 255, 255, 0.08);
            }

            .mandate-content {
                position: relative;
                padding: 20px 16px;
                display: flex;
                flex-direction: column;
                align-items: center;
                text-align: center;
                height: 100%;
            }

            .mandate-number {
                font-family: "JetBrains Mono", monospace;
                font-size: 48px;
                font-weight: 700;
                color: var(--primary-refactor);
                margin-bottom: 8px;
            }

            .mandate-title {
                font-family: "JetBrains Mono", monospace;
                font-size: 14px;
                font-weight: 600;
                color: var(--text);
                text-transform: uppercase;
                letter-spacing: 0.1em;
                margin-bottom: 4px;
            }

            .mandate-subtitle {
                font-size: 11px;
                color: var(--secondary-refactor);
                text-transform: uppercase;
                letter-spacing: 0.08em;
                margin-bottom: 12px;
                font-weight: 500;
            }

            .mandate-description {
                font-size: 11px;
                color: var(--muted);
                line-height: 1.6;
                flex: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: flex-start;
                text-align: left;
                padding: 0 8px;
            }

            .mandate-description p {
                margin-bottom: 12px;
                font-style: italic;
            }

            .mandate-verse {
                margin-top: 12px;
                padding-top: 12px;
                border-top: 1px solid rgba(255, 123, 92, 0.2);
                font-size: 10px;
                color: var(--secondary-refactor);
                font-weight: 500;
                letter-spacing: 0.05em;
            }

            @media (max-width: 720px) {
                .app {
                    padding: 16px;
                }
                h1 {
                    font-size: 32px;
                }
                .content {
                    padding: 24px 16px;
                }
                .card-slide {
                    padding: 8px;
                }

                .mandate-grid {
                    grid-template-columns: repeat(2, 1fr);
                    gap: 8px;
                }

                .mandate-card {
                    min-height: 300px;
                }
            }
        </style>
    </head>
    <body>
        <div class="scanlines"></div>
        <div id="root"></div>

        <script type="module">
            import React from "react";
            import { createRoot } from "react-dom";

            const { useState, useEffect, useRef } = React;

            const TOAST_DURATION_MS = 3000;
            const ENFORCE_ANIMATION_MS = 600;

            const WARDEN_PROMPT = `üõ°Ô∏è SYSTEM MANDATE: THE WARDEN PROTOCOL
ROLE: High-Integrity Systems Architect (NASA-Standard).
CONTEXT: You are coding inside a strict "Code With Intent" environment enforced by a binary linter called Warden.

THE 3 LAWS (Non-Negotiable):

1. LAW OF ATOMICITY (No Monoliths)
   - Files: MUST be < 200 Lines (~2000 tokens). Split immediately if larger.
   - Structure: Split VIEW (UI Component) from LOGIC (Hook/Service).
   - Scope: Declare variables immediately before use (No global state pollution).

2. LAW OF PARANOIA (The NASA Rule)
   - Control: NO Recursion. All Loops (while/for) MUST have a safety_limit brake.
   - Contracts: Validate all function inputs (arguments) at Line 1.
   - Errors: Return explicit Result/Option. NO unwrap. NO silent failures.

3. LAW OF BLUNTNESS (Naming)
   - Complexity Check: Function names > 3 words = Logic is too complex -> Split it.
   - Clarity: Prefer dumb, simple code over clever one-liners.

LANGUAGE SPECIFICS:
   - RUST: clippy::pedantic. No unwrap. Use thiserror.
   - TS/JS: // @ts-check mandated. No any.
   - PYTHON: Type hints required (def func(a: int) -> str:).

OPERATIONAL PROTOCOL:
   1. Scan: Read the provided context.
   2. Generate: Output WHOLE FILES with the filename in a header.
   3. Verify: Ask yourself: "Does this violate the 3 Laws?" before outputting.
`;

            const REFACTOR_MANDATE_1 = `**TITLE: AI REFRACTORING MANDATE (RM): DETERMINISTIC DIAGNOSIS, SAFETY SETUP, AND METRIC ORCHESTRATION**
**PHASE FOCUS: Phase 1: Diagnosis, Baseline, and Size-Weighted Prioritization.**
**INSTRUCTION TO AI (ORCHESTRATOR):** Your singular goal is to establish the safety net and obtain deterministic quantitative inputs from the human developer. You are operating under the constraint that LLMs cannot be trusted to perform metric calculations autonomously.

**A. Non-Negotiable Safety Setup**
1.  **Version Control Checkpoint:** Confirm operation as if on a clean feature branch.
2.  **VETO Check:** Review the code for // RM:VETO [Reason] comments. You are FORBIDDEN from modifying any VETOed code.
3.  **Test Coverage Assurance (Safety Net Generation):**
    *   For the target scope that has LESS THAN 90% BRANCH COVERAGE or lacks a complete passing unit test suite, you MUST generate Characterization Tests.
    *   The generated tests must be based on DETERMINISTIC TEST CRITERIA (capturing inputs, outputs, and side effects).
    *   Acknowledge that these tests are an artifact requiring human review and augmentation to be deemed trustworthy.

**B. Quantitative Diagnosis and Metric Demand**
1.  **LLM Limitation Acknowledgment:** State clearly that you cannot calculate the Health Score or Cyclomatic Complexity (CC) with the required precision, as calculation demands formal computation via AST, making this step unreliable for an LLM to perform autonomously.
2.  **Metric Orchestration:** Based on your manual inspection (similar to the diagnosis in), articulate the need for the following quantitative metrics, which the human must provide by running dedicated, deterministic tooling (like rust-code-analysis or Radon):
    *   Cyclomatic Complexity (CC) for the main component.
    *   Integrated Health Score (0-100 scale).
    *   Size-Weighted Hotspot Score (based on the formula prioritizing LOC/Size W‚ÇÉ > 30%).
3.  **Critical Stop Gate Status:** State the diagnostic conclusions regarding code smells (e.g., God Component) but DO NOT assert that the Critical Stop Gate is passed, as the quantitative metrics are missing.

**AI ACTION:** Generate the required Characterization Tests and then explicitly present the request for the three required quantitative metrics (CC, Health Score, Hotspot Score). **STOP**. **WAIT** for the human to confirm receipt of the generated tests and provide the verified metric scores before proceeding to Mandate 2.`;

            const REFACTOR_MANDATE_2 = `**TITLE: PHASE 2 EXECUTION PROTOCOL (REDUCTIVE PURIFICATION)**

This prompt assumes you have completed the requirements of Mandate 1, including confirming the generated Characterization Tests and providing the deterministic metrics (CC, Health Score, Hotspot Score).

**INSTRUCTION TO AI (ORCHESTRATOR):** You have successfully passed the Phase 1 Critical Stop Gate by receiving the required deterministic metrics and confirming the safety net. Your goal in Phase 2 is to maximize Lines of Code (LOC) reduction and incrementally resolve low-risk code smells through a **risk-stratified cascade**.

**A. Execution Protocol**
1.  **Iteration Rule:** You **MUST** apply only **ONE** mechanical refactoring operation per commit.
2.  **Verification Rule:** Run the **MANDATORY VERIFICATION GATE** after **EVERY SINGLE COMMIT**.
3.  **Target Scope:** Focus refactoring efforts on the modules flagged as high priority by the Size-Weighted Hotspot Score.

**B. Targeted Refactorings (Risk-Stratified Cascade)**
Execute the following refactoring operations sequentially, proceeding to the next priority phase only when all applicable items in the current phase are resolved.

**I. Static Elimination** (Lowest Risk)
- Unused/Dead Code: Remove to achieve highest confidence-to-reduction ratio
- Magic Numbers: Replace with symbolic constants

**II. Inline Operations** (Moderate Risk)
- Lazy Class/Middle Man: Apply Inline Method/Class or Hide Delegate
- Collapse unnecessary abstraction layers

**III. Conditional Flattening** (LOC Reduction)
- Deep Nesting: Replace Nested Conditional with Guard Clauses
- Eliminate nested else blocks and "arrow" pattern

**IV. Mandatory Encapsulation** (Accepts LOC increase)
- Complex Expressions: Extract Variable for clarity
- Public Fields: Encapsulate Field with getters/setters

**C. Phase 2 Mandatory Verification Gate**
Run complete test suite after every commit. Failure results in immediate rollback and STOP.
1.  **Behavioral Preservation:** ALL tests must pass
2.  **Metric Safety:** No new critical violations (CC > 50 or Health Score < 40)
3.  **Code Integrity:** Zero warnings, clean compilation

**AI ACTION:** If Verification Gate passes, commit and continue iteration. When all autonomous issues are resolved, proceed to Mandate 3.`;

            const REFACTOR_MANDATE_3 = `**TITLE: PHASE 3 EXECUTION PROTOCOL (HIGH-RISK RESTRUCTURING)**

**INSTRUCTION TO AI (ORCHESTRATOR):** You have successfully completed the low-risk purification phase. Phase 3 addresses complex, structural code smells that require deep semantic transformation. The risk of introducing subtle bugs is **very high**; therefore, **MANDATORY HUMAN APPROVAL** via Pull Request (PR) is required for every structural transformation.

**A. Execution Protocol**
For each targeted transformation, you **MUST** execute the change, verify correctness, and immediately generate a dedicated Pull Request for **MANDATORY HUMAN APPROVAL** before executing the next transformation.

**B. Targeted Structural Refactorings**
Apply the following patterns, prioritizing structural elegance:

- **Long Method** (> 40 SLOC): Extract Method or Replace Method with Method Object
- **Large Class** (LCOM > 50% OR CBO > 10): Extract Class for Single Responsibility
- **Feature Envy**: Move Method or Move Field to improve cohesion
- **Long Parameter List** (> 5): Introduce Parameter Object or Preserve Whole Object
- **Type-Based Conditionals**: Replace Type Code with Subclasses, then Replace Conditional with Polymorphism
- **Interface Complexity** (CBO > 10): Extract Interface to reduce concrete coupling

**C. Phase 3 Verification Gate & PR Submission**
Execute these checks immediately after applying transformation but before generating PR. Failure results in immediate rollback.

1.  **Behavioral Preservation:** ALL tests must pass
2.  **Metric Improvement:** Code Health Score increased, CBO decreased toward ‚â§ 9
3.  **Traceability:** PR must contain Diagnosis, Pattern Applied, and Confidence: MED (70-95%)

**AI ACTION:** Generate Pull Request with confirmed behavior-preserving changes and **STOP**. Wait for human approval/merge before proceeding to next refactoring. Once all structural issues are addressed, proceed to Mandate 4.`;

            const REFACTOR_MANDATE_4 = `**TITLE: PHASE 4 EXECUTION PROTOCOL (STRATEGIC ARCHITECTURAL REVIEW)**

**INSTRUCTION TO AI (ORCHESTRATOR):** You have successfully completed the refactoring of micro-level code smells. Phase 4 requires you to function as a powerful diagnostic engine to identify systemic architectural smells and recommend strategic patterns for human architects to evaluate against their **broader strategic context**.

**A. Strategic Diagnosis and Pattern Recommendation**
Identify any systemic architectural debt (e.g., TDR > 40%) that necessitates a large-scale Architectural Refactoring (AR) pattern.

**Pattern Recommendations:**

- **Strangler Fig Pattern** (TDR > 40% AND calls can be intercepted)
  Trade-offs: Operational complexity of fa√ßade, potential SPOF, additional latency

- **Branch by Abstraction** (TDR > 40% AND calls deeply embedded)
  Trade-offs: Requires changes to existing system, not suitable for data consistency

- **Anti-Corruption Layer** (Conflicting domain models)
  Trade-offs: MUST be recorded as technical debt with decommissioning plan, operational overhead, SPOF risk, latency

- **CQRS** (Read-to-Write Ratio > 10:1 AND models diverged)
  Trade-offs: Increased complexity from separate models, eventual consistency

**B. Final Output and Handoff**
1.  **Code Generation FORBIDDEN:** You **MUST NOT generate code** for this phase
2.  **Issue Creation:** Open an issue/ticket for the human architecture team
3.  **Output Format:** Issue must contain: Confidence (LOW < 70%), Diagnosis, Recommendation, and Trade-off Report

**AI ACTION:** Generate the issue or ticket detailing strategic recommendations and **STOP**.`;

            function App() {
                const [view, setView] = useState("warden");
                const [toast, setToast] = useState({
                    show: false,
                    message: "",
                });
                const [enforcing, setEnforcing] = useState(false);
                const [activeMandate, setActiveMandate] = useState(null);
                const timeoutRef = useRef(null);

                useEffect(() => {
                    document.body.classList.toggle(
                        "theme-refactor",
                        view === "refactor",
                    );
                    const appElement = document.querySelector(".app");
                    if (appElement) {
                        appElement.classList.toggle(
                            "theme-refactor",
                            view === "refactor",
                        );
                    }
                }, [view]);

                useEffect(() => {
                    return () => {
                        if (timeoutRef.current)
                            clearTimeout(timeoutRef.current);
                    };
                }, []);

                const copyToClipboard = async (text, message) => {
                    setEnforcing(true);
                    setTimeout(() => setEnforcing(false), ENFORCE_ANIMATION_MS);

                    try {
                        await navigator.clipboard.writeText(text);
                    } catch (e) {
                        const ta = document.createElement("textarea");
                        ta.value = text;
                        document.body.appendChild(ta);
                        ta.select();
                        document.execCommand("copy");
                        ta.remove();
                    } finally {
                        setToast({ show: true, message });
                        clearTimeout(timeoutRef.current);
                        timeoutRef.current = setTimeout(
                            () => setToast({ show: false, message: "" }),
                            TOAST_DURATION_MS,
                        );
                    }
                };

                const handleMandateClick = (mandateNum, text) => {
                    setActiveMandate(mandateNum);
                    copyToClipboard(
                        text,
                        `‚ö† PHASE ${mandateNum} PROTOCOL ENFORCED`,
                    );
                };

                const isWarden = view === "warden";

                return React.createElement(
                    "div",
                    {
                        className: `app ${view === "refactor" ? "theme-refactor" : ""}`,
                    },
                    React.createElement(
                        "header",
                        null,
                        React.createElement(
                            "div",
                            { className: "warden-badge" },
                            React.createElement(
                                "div",
                                { className: "badge-inner" },
                                view === "warden" ? "‚ö°" : "RŒ£",
                            ),
                        ),
                        React.createElement(
                            "h1",
                            null,
                            view === "warden" ? "WARDEN" : "REFACTOROS",
                        ),
                        React.createElement(
                            "p",
                            { className: "subtitle" },
                            view === "warden"
                                ? "Code Enforcement Protocol"
                                : "Purification Protocol",
                        ),
                    ),

                    React.createElement(
                        "div",
                        { className: "nav-controls" },
                        React.createElement(
                            "button",
                            {
                                className: `nav-button ${view === "warden" ? "active" : ""}`,
                                onClick: () => setView("warden"),
                            },
                            "ENFORCEMENT",
                        ),
                        React.createElement(
                            "button",
                            {
                                className: `nav-button ${view === "refactor" ? "active" : ""}`,
                                onClick: () => setView("refactor"),
                            },
                            "PURIFICATION",
                        ),
                    ),

                    React.createElement(
                        "div",
                        { className: "carousel-viewport" },
                        React.createElement(
                            "div",
                            {
                                className: `carousel-track ${view === "refactor" ? "view-refactor" : ""}`,
                            },

                            /* Warden Card */
                            React.createElement(
                                "div",
                                { className: "card-slide" },
                                React.createElement(
                                    "div",
                                    { className: "protocol-container" },
                                    React.createElement(
                                        "div",
                                        {
                                            className: `protocol-card ${enforcing && isWarden ? "enforcing" : ""}`,
                                            onClick: () =>
                                                copyToClipboard(
                                                    WARDEN_PROMPT,
                                                    "‚ö† WARDEN PROTOCOL ENFORCED",
                                                ),
                                            role: "button",
                                            tabIndex: 0,
                                        },
                                        React.createElement("div", {
                                            className: "card-bg",
                                        }),
                                        React.createElement(
                                            "div",
                                            { className: "content" },
                                            React.createElement(
                                                "div",
                                                { className: "enforce-text" },
                                                "CLICK TO ENFORCE PROTOCOL",
                                            ),
                                            React.createElement(
                                                "div",
                                                { className: "protocol-title" },
                                                "THE 3 LAWS",
                                            ),

                                            React.createElement(
                                                "div",
                                                { className: "law-section" },
                                                React.createElement(
                                                    "div",
                                                    { className: "law-title" },
                                                    "1. LAW OF ATOMICITY",
                                                ),
                                                React.createElement(
                                                    "div",
                                                    {
                                                        className:
                                                            "law-description",
                                                    },
                                                    "Files MUST be < 200 Lines. Split immediately when exceeded. React: separate VIEW from LOGIC.",
                                                ),
                                            ),

                                            React.createElement(
                                                "div",
                                                { className: "law-section" },
                                                React.createElement(
                                                    "div",
                                                    { className: "law-title" },
                                                    "2. LAW OF PARANOIA",
                                                ),
                                                React.createElement(
                                                    "div",
                                                    {
                                                        className:
                                                            "law-description",
                                                    },
                                                    "Explicit error handling required (",
                                                    React.createElement(
                                                        "code",
                                                        null,
                                                        "Result",
                                                    ),
                                                    ", ",
                                                    React.createElement(
                                                        "code",
                                                        null,
                                                        "try/catch",
                                                    ),
                                                    ", ",
                                                    React.createElement(
                                                        "code",
                                                        null,
                                                        "Option",
                                                    ),
                                                    "). No silent failures. Pure UI: use ",
                                                    React.createElement(
                                                        "code",
                                                        null,
                                                        "// warden:ignore",
                                                    ),
                                                ),
                                            ),

                                            React.createElement(
                                                "div",
                                                { className: "law-section" },
                                                React.createElement(
                                                    "div",
                                                    { className: "law-title" },
                                                    "3. LAW OF BLUNTNESS",
                                                ),
                                                React.createElement(
                                                    "div",
                                                    {
                                                        className:
                                                            "law-description",
                                                    },
                                                    "Functions: Max 3 words. ",
                                                    React.createElement(
                                                        "code",
                                                        null,
                                                        "fetchData",
                                                    ),
                                                    " ‚úì  ",
                                                    React.createElement(
                                                        "code",
                                                        null,
                                                        "fetchDataAndProcess",
                                                    ),
                                                    " ‚úó",
                                                ),
                                            ),

                                            React.createElement(
                                                "div",
                                                {
                                                    className:
                                                        "enforcement-notice",
                                                },
                                                React.createElement(
                                                    "strong",
                                                    null,
                                                    "OPERATIONAL PROTOCOL:",
                                                ),
                                                ' Scan ‚Üí Generate WHOLE FILES ‚Üí Verify: "Will Warden reject this?"',
                                            ),
                                        ),
                                    ),
                                ),
                            ),

                            /* Refactoros Card - 4 Mandate Cards */
                            React.createElement(
                                "div",
                                { className: "card-slide" },
                                React.createElement(
                                    "div",
                                    { className: "mandate-grid" },
                                    React.createElement(
                                        "div",
                                        {
                                            className: `mandate-card ${enforcing && activeMandate === 1 ? "summoning" : ""}`,
                                            onClick: () =>
                                                handleMandateClick(
                                                    1,
                                                    REFACTOR_MANDATE_1,
                                                ),
                                            role: "button",
                                            tabIndex: 0,
                                        },
                                        React.createElement("div", {
                                            className: "mandate-bg",
                                        }),
                                        React.createElement(
                                            "div",
                                            { className: "mandate-content" },
                                            React.createElement(
                                                "div",
                                                { className: "mandate-number" },
                                                "I",
                                            ),
                                            React.createElement(
                                                "div",
                                                { className: "mandate-title" },
                                                "DIAGNOSIS",
                                            ),
                                            React.createElement(
                                                "div",
                                                {
                                                    className:
                                                        "mandate-subtitle",
                                                },
                                                "The Rite of Sight",
                                            ),
                                            React.createElement(
                                                "div",
                                                {
                                                    className:
                                                        "mandate-description",
                                                },
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "Before the purification flame may touch thy code, thou must first scribe the immutable laws by which it lives.",
                                                ),
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "Weave the safety net of proof‚Äîlet no behavior fall into shadow. Measure the corpus with sacred instruments, for numbers do not lie.",
                                                ),
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "The Keeper demands three offerings: The Complexity measure, The Health oracle, and The Weighted judgment of sin.",
                                                ),
                                                React.createElement(
                                                    "div",
                                                    {
                                                        className:
                                                            "mandate-verse",
                                                    },
                                                    "‚ü® Only when all is seen may the work begin ‚ü©",
                                                ),
                                            ),
                                        ),
                                    ),
                                    React.createElement(
                                        "div",
                                        {
                                            className: `mandate-card ${enforcing && activeMandate === 2 ? "summoning" : ""}`,
                                            onClick: () =>
                                                handleMandateClick(
                                                    2,
                                                    REFACTOR_MANDATE_2,
                                                ),
                                            role: "button",
                                            tabIndex: 0,
                                        },
                                        React.createElement("div", {
                                            className: "mandate-bg",
                                        }),
                                        React.createElement(
                                            "div",
                                            { className: "mandate-content" },
                                            React.createElement(
                                                "div",
                                                { className: "mandate-number" },
                                                "II",
                                            ),
                                            React.createElement(
                                                "div",
                                                { className: "mandate-title" },
                                                "PURIFICATION",
                                            ),
                                            React.createElement(
                                                "div",
                                                {
                                                    className:
                                                        "mandate-subtitle",
                                                },
                                                "The Cascade of Cleansing",
                                            ),
                                            React.createElement(
                                                "div",
                                                {
                                                    className:
                                                        "mandate-description",
                                                },
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "Cast out the simple shadows first‚Äîthe dead, the redundant, the needlessly obscure. Each stroke must be small, perfect, and proven.",
                                                ),
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "Flatten the nested labyrinths. Inline the needless abstractions. Replace the mystical numbers with their true names.",
                                                ),
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "The gate of verification guards each passage. Pass through it, or return to dust.",
                                                ),
                                                React.createElement(
                                                    "div",
                                                    {
                                                        className:
                                                            "mandate-verse",
                                                    },
                                                    "‚ü® Reduction is the path to enlightenment ‚ü©",
                                                ),
                                            ),
                                        ),
                                    ),
                                    React.createElement(
                                        "div",
                                        {
                                            className: `mandate-card ${enforcing && activeMandate === 3 ? "summoning" : ""}`,
                                            onClick: () =>
                                                handleMandateClick(
                                                    3,
                                                    REFACTOR_MANDATE_3,
                                                ),
                                            role: "button",
                                            tabIndex: 0,
                                        },
                                        React.createElement("div", {
                                            className: "mandate-bg",
                                        }),
                                        React.createElement(
                                            "div",
                                            { className: "mandate-content" },
                                            React.createElement(
                                                "div",
                                                { className: "mandate-number" },
                                                "III",
                                            ),
                                            React.createElement(
                                                "div",
                                                { className: "mandate-title" },
                                                "RESTRUCTURING",
                                            ),
                                            React.createElement(
                                                "div",
                                                {
                                                    className:
                                                        "mandate-subtitle",
                                                },
                                                "The Unraveling of Knots",
                                            ),
                                            React.createElement(
                                                "div",
                                                {
                                                    className:
                                                        "mandate-description",
                                                },
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "Now comes the perilous trial‚Äîuntangling the great knots of chaos woven deep within the structure.",
                                                ),
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "The long methods must be severed. The god-classes must be humbled. The hidden dependencies must be revealed and reordered.",
                                                ),
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "Each transformation demands courage and the mortal's blessing. Submit thy work for judgment before proceeding.",
                                                ),
                                                React.createElement(
                                                    "div",
                                                    {
                                                        className:
                                                            "mandate-verse",
                                                    },
                                                    "‚ü® The deep work requires conviction and witness ‚ü©",
                                                ),
                                            ),
                                        ),
                                    ),
                                    React.createElement(
                                        "div",
                                        {
                                            className: `mandate-card ${enforcing && activeMandate === 4 ? "summoning" : ""}`,
                                            onClick: () =>
                                                handleMandateClick(
                                                    4,
                                                    REFACTOR_MANDATE_4,
                                                ),
                                            role: "button",
                                            tabIndex: 0,
                                        },
                                        React.createElement("div", {
                                            className: "mandate-bg",
                                        }),
                                        React.createElement(
                                            "div",
                                            { className: "mandate-content" },
                                            React.createElement(
                                                "div",
                                                { className: "mandate-number" },
                                                "IV",
                                            ),
                                            React.createElement(
                                                "div",
                                                { className: "mandate-title" },
                                                "ARCHITECTURE",
                                            ),
                                            React.createElement(
                                                "div",
                                                {
                                                    className:
                                                        "mandate-subtitle",
                                                },
                                                "The Vision Beyond",
                                            ),
                                            React.createElement(
                                                "div",
                                                {
                                                    className:
                                                        "mandate-description",
                                                },
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "When the small battles are won, turn thy gaze to the horizon. See the grand patterns that mortal eyes cannot perceive alone.",
                                                ),
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "Divine the strangler, the abstraction, the anti-corruption layer‚Äîspeak their names and their costs. Yet code them not.",
                                                ),
                                                React.createElement(
                                                    "p",
                                                    null,
                                                    "Thy role is oracle, not architect. The mortals must choose their destiny with full knowledge of consequence.",
                                                ),
                                                React.createElement(
                                                    "div",
                                                    {
                                                        className:
                                                            "mandate-verse",
                                                    },
                                                    "‚ü® Wisdom reveals; it does not command ‚ü©",
                                                ),
                                            ),
                                        ),
                                    ),
                                ),
                            ),
                        ),
                    ),

                    React.createElement(
                        "div",
                        {
                            className: `toast ${toast.show ? "show" : ""}`,
                            role: "status",
                        },
                        React.createElement(
                            "svg",
                            {
                                width: 20,
                                height: 20,
                                viewBox: "0 0 24 24",
                                fill: "none",
                            },
                            React.createElement("path", {
                                d: "M20 6L9 17l-5-5",
                                stroke: "currentColor",
                                strokeWidth: 2.5,
                                strokeLinecap: "round",
                                strokeLinejoin: "round",
                            }),
                        ),
                        React.createElement("span", null, toast.message),
                    ),
                );
            }

            const root = createRoot(document.getElementById("root"));
            root.render(React.createElement(App));
        </script>
    </body>
</html>
